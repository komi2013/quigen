<VirtualHost *:80>
    ServerName review.komahana.info
    DocumentRoot /prd/review/
    LogLevel error
  <Directory "/prd/review">
      AllowOverride all
      Allow From All
    <Files .*>
      Order Deny,Allow
      Deny From All
    </Files>
      RewriteEngine On
      RewriteBase /prd/review
      RewriteRule ^(?:application|modules|system)\b.* /index.php/$0 [L]
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteRule .* /index.php/$0 [PT]
  </Directory>
  CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/review/acs.%Y%m%d 86400 540" combined
  ErrorLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/review/err.%Y%m%d 86400 540"
</VirtualHost>

<VirtualHost *:80>
    ServerName etopet.komahana.info
    DocumentRoot /prd/etopet/
    LogLevel error
  <Directory "/prd/etopet">
      AllowOverride all
      Allow From All
    <Files .*>
      Order Deny,Allow
      Deny From All
    </Files>
      RewriteEngine On
      RewriteBase /prd/etopet
      RewriteRule ^(?:application|modules|system)\b.* /index.php/$0 [L]
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteRule .* /index.php/$0 [PT]
  </Directory>
  CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/etopet/acs.%Y%m%d 86400 540" combined
  ErrorLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/etopet/err.%Y%m%d 86400 540"
</VirtualHost>


<VirtualHost *:80>
  ExpiresActive on
  ExpiresByType image/png "access plus 1 months"
  ExpiresByType image/jpeg "access plus 1 months"
  ExpiresByType image/gif "access plus 1 months"
  ExpiresByType text/css "access plus 1 months"
  ExpiresByType text/javascript "access plus 1 months"
  ExpiresByType application/x-javascript "access plus 1 months"
  ExpiresByType application/x-shockwave-flash "access plus 1 months"
  ExpiresDefault "access plus 0 months"

  ServerName generator.komahana.info
  DocumentRoot /prd/generator/public/
  LogLevel error
  <Directory "/prd/generator/public">
      AllowOverride all
      Allow From All
    <Files .*>
      Order Deny,Allow
      Deny From All
    </Files>
      RewriteEngine On
      RewriteBase /prd/generator/public
      RewriteRule ^(?:application|modules|system)\b.* /index.php/$0 [L]
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteRule .* /index.php/$0 [PT]
#     <IfModule mod_expires.c>
#       ExpiresActive on
#       ExpiresDefault "access plus 0 hours"
#     </IfModule>
    <IfModule mod_deflate.c>
      SetOutputFilter DEFLATE
      # Mozilla4系などの古いブラウザで無効、しかしMSIEは除外
      BrowserMatch ^Mozilla/4\.0[678] no-gzip
      BrowserMatch ^Mozilla/4 gzip-only-text/html
      BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html
      # gifやjpgなど圧縮済みのコンテンツは再圧縮しない
      SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png|ico)$ no-gzip dont-vary
      SetEnvIfNoCase Request_URI _\.utxt$ no-gzip
      # htmlやcssなどは圧縮
      AddOutputFilterByType DEFLATE text/plain
      AddOutputFilterByType DEFLATE text/html
      AddOutputFilterByType DEFLATE text/css
      AddOutputFilterByType DEFLATE application/x-javascript
      AddOutputFilterByType DEFLATE application/javascript
      AddOutputFilterByType DEFLATE application/x-httpd-php
    </IfModule>
  </Directory>

  CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/generator/acs.%Y%m%d 86400 540" combined env=!nolog

  SetEnvIf Remote_Addr "58.156.28.123" nolog
  SetEnvIf User-Agent "facebookexternalhit" nolog
  SetEnvIf User-Agent "TweetmemeBot" nolog
  SetEnvIf User-Agent "www.tkl.iis.u-tokyo.ac.jp" nolog
  SetEnvIf User-Agent "Googlebot" nolog
  SetEnvIf User-Agent "YandexBot" nolog
  SetEnvIf User-Agent "360Spider" nolog
  SetEnvIf User-Agent "Mediapartners-Google" nolog
  SetEnvIf User-Agent "Yahoo! Slurp" nolog
  SetEnvIf User-Agent "bingbot" nolog
  SetEnvIf User-Agent "Twitterbot" nolog
  SetEnvIf User-Agent "crawler" nolog
  SetEnvIf Request_URI "robots.txt" nolog
  SetEnvIf Request_URI "assets" nolog
  SetEnvIf Request_URI "show" nolog
  SetEnvIf Request_URI "crypt" nolog
  SetEnvIf Request_URI "\.(gif|jpg|png|css|js)$" nolog 
  SetEnvIf Request_URI "^/_mem_bin/" nolog
  SetEnvIf Request_URI "^/_vti_bin/" nolog
  SetEnvIf Request_URI "^/c/" nolog
  SetEnvIf Request_URI "^/d/" nolog
  SetEnvIf Request_URI "^/msadc/" nolog
  SetEnvIf Request_URI "^/MSADC/" nolog
  SetEnvIf Request_URI "^/scripts/" nolog
  SetEnvIf Request_URI "^/default.ida" nolog

  ErrorLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/generator/err.%Y%m%d 86400 540"
</VirtualHost>

<VirtualHost *:80>
    ServerName www.komahana.info
    DocumentRoot /prd/www/fuel/public/
    LogLevel debug
#    Alias /intranet "/prd/www/fuel/public/"
   <Directory "/prd/www/fuel/public">
#      Redirect / http://generator.komahana.info/
#       AllowOverride all
#       Allow From All
     <Files .*>
       Order Deny,Allow
       Deny From All
     </Files>
       RewriteEngine On
       RewriteCond %{http_host} ^www.komahana.info
       RewriteRule ^(.*) http://generator.komahana.info/$1 [R=301,L]

#       RewriteBase /prd/www
#       RewriteRule ^(?:application|modules|system)\b.* /index.php/$0 [L]
       RewriteCond %{REQUEST_FILENAME} !-f
       RewriteCond %{REQUEST_FILENAME} !-d
#RewriteRule ^laravel/(.*)$ /index.php/?no=$1 [L]
#RewriteRule ^bbs/(.*)$ /bbs.php?no=$1 [QSA]
       RewriteRule .* /index.php/$0 [PT]

#RewriteCond %{REQUEST_URI} !^/laravel/public/
#RewriteRule ^laravel/(.*) /laravel/public/index.php/$1


   </Directory>
  CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/www/acs.%Y%m%d 86400 540" combined
  ErrorLog "|/usr/sbin/rotatelogs /var/log/httpd/prd/www/err.%Y%m%d 86400 540"
</VirtualHost>
