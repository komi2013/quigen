<VirtualHost *:80>
  ExpiresActive on
  ExpiresByType image/png "access plus 1 months"
  ExpiresByType image/jpeg "access plus 1 months"
  ExpiresByType image/gif "access plus 1 months"
  ExpiresByType text/css "access plus 1 months"
  ExpiresByType text/javascript "access plus 1 months"
  ExpiresByType application/x-javascript "access plus 1 months"
  ExpiresByType application/x-shockwave-flash "access plus 1 months"
  ExpiresDefault "access plus 0 months"

  ServerName juken.quigen.info
  DocumentRoot /prd/juken/public/
  LogLevel error
  <Directory "/prd/juken/public">
      AllowOverride all
      Allow From All
    <Files .*>
      Order Deny,Allow
      Deny From All
    </Files>
      RewriteEngine On
      RewriteBase /prd/juken/public
      RewriteRule ^(?:application|modules|system)\b.* /index.php/$0 [L]
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteRule .* /index.php/$0 [PT]
    <IfModule mod_deflate.c>
      SetOutputFilter DEFLATE
      BrowserMatch ^Mozilla/4\.0[678] no-gzip
      BrowserMatch ^Mozilla/4 gzip-only-text/html
      BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html
      SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png|ico)$ no-gzip dont-vary
      SetEnvIfNoCase Request_URI _\.utxt$ no-gzip
      AddOutputFilterByType DEFLATE text/plain
      AddOutputFilterByType DEFLATE text/html
      AddOutputFilterByType DEFLATE text/css
      AddOutputFilterByType DEFLATE application/x-javascript
      AddOutputFilterByType DEFLATE application/javascript
      AddOutputFilterByType DEFLATE application/x-httpd-php
    </IfModule>
  </Directory>

  CustomLog "|/usr/sbin/rotatelogs /prd/juken/httpd_log/acs_%Y%m%d.csv 86400 540" combined env=!nolog

  SetEnvIf Request_URI "robots.txt" nolog
  SetEnvIf Request_URI "assets" nolog
  SetEnvIf Request_URI "show" nolog
  SetEnvIf QUERY_STRING "crypt" nolog
  SetEnvIf Request_URI "\.(gif|jpg|png|css|js)$" nolog 
  SetEnvIf QUERY_STRING "^/p\=ad/" nolog 
  SetEnvIf Request_URI "htm/ad" nolog

#   SetEnvIf Remote_Addr "58.156.28.123" nolog
#   SetEnvIf User-Agent "facebookexternalhit" nolog
#   SetEnvIf User-Agent "TweetmemeBot" nolog
#   SetEnvIf User-Agent "www.tkl.iis.u-tokyo.ac.jp" nolog
#   SetEnvIf User-Agent "Googlebot" nolog
#   SetEnvIf User-Agent "YandexBot" nolog
#   SetEnvIf User-Agent "360Spider" nolog
#   SetEnvIf User-Agent "Mediapartners-Google" nolog
#   SetEnvIf User-Agent "Yahoo! Slurp" nolog
#   SetEnvIf User-Agent "bingbot" nolog
#   SetEnvIf User-Agent "Twitterbot" nolog
#   SetEnvIf User-Agent "crawler" nolog
#   SetEnvIf Request_URI "^/_mem_bin/" nolog
#   SetEnvIf Request_URI "^/_vti_bin/" nolog
#   SetEnvIf Request_URI "^/c/" nolog
#   SetEnvIf Request_URI "^/d/" nolog
#   SetEnvIf Request_URI "^/msadc/" nolog
#   SetEnvIf Request_URI "^/MSADC/" nolog
#   SetEnvIf Request_URI "^/scripts/" nolog
#   SetEnvIf Request_URI "^/default.ida" nolog

  ErrorLog "|/usr/sbin/rotatelogs /prd/juken/httpd_log/err.%Y%m%d 86400 540 combined"
</VirtualHost>
